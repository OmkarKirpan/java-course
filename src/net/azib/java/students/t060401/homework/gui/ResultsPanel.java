/*
 * ResultsPanel.java
 */

package net.azib.java.students.t060401.homework.gui;

import net.azib.java.students.t060401.homework.decathlon.DecathlonInfoVector;
import net.azib.java.students.t060401.homework.util.LanguageUtil;

import java.io.File;
import java.util.Arrays;
import java.util.Vector;

import javax.swing.GroupLayout;
import javax.swing.JFileChooser;

/**
 * Panel with components for showing decathlon data table and saving it into a file.
 *
 * @author t060401
 */
public class ResultsPanel extends javax.swing.JPanel {

	/** serialVersionUID */
	private static final long serialVersionUID = 1L;

	private static String[] tableHeader = new String[] {
		LanguageUtil.getString("Info.Place"),
		LanguageUtil.getString("Info.Points"),
		LanguageUtil.getString("Info.Name"),
		LanguageUtil.getString("Info.BirthDate"), 
		LanguageUtil.getString("Info.Country"),
		LanguageUtil.getString("Info.Sprint100m"), 
		LanguageUtil.getString("Info.LongJump"),
		LanguageUtil.getString("Info.ShotPut"),
		LanguageUtil.getString("Info.HighJump"),
		LanguageUtil.getString("Info.Sprint400m"),
		LanguageUtil.getString("Info.Hurdles110m"),
		LanguageUtil.getString("Info.DiscusThrow"),
		LanguageUtil.getString("Info.PoleVault"),
		LanguageUtil.getString("Info.JavelinThrow"),
		LanguageUtil.getString("Info.Race1500m") };

	DecathlonInfoVector decathlonVector;

	/** Creates new form ResultsPanel */
	public ResultsPanel(DecathlonInfoVector decathlonVector) {
		this.decathlonVector = decathlonVector;
		initComponents();
	}

	/**
	 * This method is called from within the constructor to initialize the form.
	 * WARNING: Do NOT modify this code. The content of this method is always
	 * regenerated by the Form Editor.
	 */
	// <editor-fold defaultstate="collapsed" desc=" Generated Code
	// ">//GEN-BEGIN:initComponents
	private void initComponents() {
		swingFileDialog = new JFileChooser();
		
		jScrollPane1 = new javax.swing.JScrollPane();
		resultsTable = new javax.swing.JTable();
		saveFileButton = new javax.swing.JButton();
		clearResultsButton = new javax.swing.JButton();

		addComponentListener(new java.awt.event.ComponentAdapter() {
            public void componentShown(java.awt.event.ComponentEvent evt) {
                formComponentShown(evt);
            }
        });
		
		resultsTable.setModel(new javax.swing.table.DefaultTableModel(
				decathlonVector.toSortedVector(), new Vector<String>(Arrays.asList(tableHeader) )));
				// decathlonVector.toSortedArray(), tableHeader));

		resultsTable.setAutoResizeMode(javax.swing.JTable.AUTO_RESIZE_OFF);
		
		jScrollPane1.setViewportView(resultsTable);

		saveFileButton.setText(LanguageUtil.getString("Results.Save"));
		saveFileButton.addMouseListener(new java.awt.event.MouseAdapter() {
			public void mouseClicked(java.awt.event.MouseEvent evt) {
				saveFileButtonMouseClicked(evt);
			}
		});

		clearResultsButton.setText(LanguageUtil.getString("Results.Clear"));
        clearResultsButton.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                clearResultsButtonMouseClicked(evt);
            }
        });
            
       GroupLayout layout = new GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(GroupLayout.Alignment.LEADING)
                    .addComponent(jScrollPane1,GroupLayout.DEFAULT_SIZE,GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(layout.createSequentialGroup()
                        .addComponent(saveFileButton)
                        .addGap(21, 21, 21)
                        .addComponent(clearResultsButton)))
                .addGap(15, 15, 15))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addContainerGap()
                .addGroup(layout.createParallelGroup(GroupLayout.Alignment.BASELINE)
                    .addComponent(saveFileButton)
                    .addComponent(clearResultsButton))
                .addGap(8, 8, 8)
                .addComponent(jScrollPane1,GroupLayout.DEFAULT_SIZE, 247, Short.MAX_VALUE)
                .addContainerGap())
        );
    }
	
	private void clearResultsButtonMouseClicked(java.awt.event.MouseEvent evt) {
		decathlonVector.clear();
		reloadTable();
	}

	private void saveFileButtonMouseClicked(java.awt.event.MouseEvent evt) {// GEN-FIRST:event_saveFileButtonMouseClicked
		int returnVal = swingFileDialog.showSaveDialog(this);
		this.repaint();
		if (returnVal == JFileChooser.APPROVE_OPTION) {
			File selectedFile = swingFileDialog.getSelectedFile();
			String filePath = selectedFile.getPath();

			if (decathlonVector!=null)
			{
				try {
					decathlonVector.saveDecathlonInfoVector(filePath);
				}
				catch (Exception e) {
					// TODO: display info message
				}
			}
		}
	}// GEN-LAST:event_saveFileButtonMouseClicked

	private void formComponentShown(java.awt.event.ComponentEvent evt) {
		reloadTable();
	}

	// Variables declaration - do not modify//GEN-BEGIN:variables
	private javax.swing.JScrollPane jScrollPane1;
	private javax.swing.JTable resultsTable;
	private javax.swing.JButton saveFileButton;
	private javax.swing.JButton clearResultsButton;
	private JFileChooser swingFileDialog;

	// End of variables declaration//GEN-END:variables

	private void reloadTable() {
		Vector<String> headerVector = new Vector<String>(Arrays
						.asList(tableHeader));
		resultsTable.setModel(new javax.swing.table.DefaultTableModel(decathlonVector.toSortedVector(), headerVector));
	}
}
